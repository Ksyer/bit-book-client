(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5eeb2ded"],{"0093":function(t,e,i){"use strict";var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("transition",{attrs:{name:"fade"}},[i("div",{staticClass:"shelf-title-wrapper",class:{"hide-shadow":t.ifHideShadow}},[i("div",{staticClass:"title"},[i("span",{staticClass:"title-text"},[t._v(t._s(t.title))]),i("span",{directives:[{name:"show",rawName:"v-show",value:t.isEditMode,expression:"isEditMode"}],staticClass:"sub-title-text"},[t._v(t._s(t.selectedText))])]),t.ifGroupEmpty||t.isDataEmpty?t._e():i("div",{staticClass:"btn-text-wrapper",on:{click:t.onEditClick}},[i("span",{staticClass:"btn-text"},[t._v(t._s(t.isEditMode?t.$t("shelf.cancel"):t.$t("shelf.edit")))])]),t.ifGroupEmpty&&!t.isDataEmpty?i("div",{staticClass:"btn-text-wrapper",on:{click:t.changeGroup}},[i("span",{staticClass:"btn-text"},[t._v(t._s(t.$t("shelf.editGroup")))])]):t._e(),t.isDataEmpty?i("div",{staticClass:"btn-text-wrapper",on:{click:t.changeLanguage}},[i("span",{staticClass:"btn-text"},[t._v(t._s(t.$t("shelf.changeLanguage")))])]):t._e(),t.ifShowClear&&!t.isDataEmpty?i("div",{staticClass:"btn-clear-wrapper",on:{click:t.clearCache}},[i("span",{staticClass:"btn-clear"},[t._v(t._s(t.$t("shelf.clearCache")))])]):t._e(),t.ifShowBack&&!t.isEditMode?i("div",{staticClass:"btn-back-wrapper",on:{click:t.back}},[i("span",{staticClass:"icon-back"})]):t._e(),t.ifShowBack&&t.isEditMode?i("div",{staticClass:"btn-back-wrapper",on:{click:t.changeGroup}},[i("span",{staticClass:"btn-text"},[t._v(t._s(t.$t("shelf.editGroup")))])]):t._e(),i("popup",{ref:"popup",attrs:{title:t.popupTitle,thirdText:t.thirdText,confirmText:t.confirmText,isRemoveText:!0,cancelText:t.$t("shelf.cancel")},on:{confirm:t.onPopupDelete,third:t.onPopupChange}}),i("shelf-group-dialog",{ref:"groupDialog",attrs:{visible:t.ifGroupDialogShow,isEditGroupName:!0,category:t.category},on:{"update:visible":function(e){t.ifGroupDialogShow=e},editGroupName:t.editGroupName}})],1)])},s=[],r=(i("4de4"),i("ac1f"),i("5319"),i("8663")),n=i("3fbb"),a=i("5de6"),c={components:{ShelfGroupDialog:n["a"],Popup:r["a"]},props:{isEditMode:Boolean,ifShowBack:Boolean,ifShowClear:Boolean,ifGroupEmpty:Boolean,data:Array,title:String,category:Object},computed:{isDataEmpty:function(){return!this.data||0===this.data.filter((function(t){return 3!==t.type})).length},selectedText:function(){return 0===this.selectedNumber?this.$t("shelf.selectBook"):1===this.selectedNumber?this.$t("shelf.haveSelectedBook").replace("$1",this.selectedNumber):this.$t("shelf.haveSelectedBooks").replace("$1",this.selectedNumber)},selectedNumber:function(){return this.category&&this.category.itemList?this.category.itemList.filter((function(t){return t.selected})).length:this.data?this.data.filter((function(t){return t.selected})).length:0},thirdText:function(){return this.isDeleteGroup?"":this.$t("shelf.editGroupName")},popupTitle:function(){return this.isDeleteGroup?this.$t("shelf.deleteGroupTitle"):""},confirmText:function(){return this.isDeleteGroup?this.$t("shelf.confirm"):this.$t("shelf.deleteGroup")}},data:function(){return{ifHideShadow:!0,ifGroupDialogShow:!1,isDeleteGroup:!1}},methods:{changeLanguage:function(){Object(a["n"])(this)},editGroupName:function(t,e){this.$emit("editGroupName",t,e)},showPopup:function(){this.$refs.popup.show()},onPopupDelete:function(){var t=this;this.isDeleteGroup?(this.$emit("deleteGroup",this.category),this.isDeleteGroup=!1):(this.$refs.popup.hide(),setTimeout((function(){t.isDeleteGroup=!0,t.$refs.popup.show()}),200))},onPopupChange:function(){this.ifGroupDialogShow=!0,this.$refs.groupDialog.showEditGroupDialog()},changeGroup:function(){this.showPopup()},back:function(){this.$router.go(-1)},clearCache:function(){this.$emit("clearCache")},showShadow:function(){this.ifHideShadow=!1},hideShadow:function(){this.ifHideShadow=!0},onEditClick:function(){this.isEditMode?this.$emit("onEditClick",!1):this.$emit("onEditClick",!0)}}},l=c,u=(i("e5b5"),i("2877")),h=Object(u["a"])(l,o,s,!1,null,"38787b2e",null);e["a"]=h.exports},"1da1":function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));i("d3b7");function o(t,e,i,o,s,r,n){try{var a=t[r](n),c=a.value}catch(l){return void i(l)}a.done?e(c):Promise.resolve(c).then(o,s)}function s(t){return function(){var e=this,i=arguments;return new Promise((function(s,r){var n=t.apply(e,i);function a(t){o(n,s,r,a,c,"next",t)}function c(t){o(n,s,r,a,c,"throw",t)}a(void 0)}))}}},2909:function(t,e,i){"use strict";function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,o=new Array(e);i<e;i++)o[i]=t[i];return o}function s(t){if(Array.isArray(t))return o(t)}i.d(e,"a",(function(){return c}));i("a4d3"),i("e01a"),i("d3b7"),i("d28b"),i("3ca3"),i("ddb0"),i("a630");function r(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}i("fb6a"),i("b0c0");function n(t,e){if(t){if("string"===typeof t)return o(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?o(t,e):void 0}}function a(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(t){return s(t)||r(t)||n(t)||a()}},"2c89":function(t,e,i){"use strict";var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"book-shelf-wrapper"},[0===t.showType||1===t.showType?i("transition-group",{attrs:{name:"list",tag:"div",id:"book-shelf-list"}},t._l(t.bookData,(function(e,o){return i("div",{key:e.id,staticClass:"book-shelf-item",on:{click:function(i){return t.onBookClick(e,o)}}},[i("div",{ref:"bookImg",refInFor:!0,staticClass:"book-img-wrapper",class:{"add-book":3===e.type,"category-book":2===e.type}},[1===e.type?i("shelf-image",{attrs:{data:e,isEditMode:t.isEditMode}}):2===e.type?i("shelf-category",{attrs:{data:e,isEditMode:t.isEditMode}}):i("span",{staticClass:"icon-add icon"})],1),i("div",{staticClass:"book-title-wrapper"},[i("span",{staticClass:"book-title title-small"},[t._v(t._s(e.title))])])])})),0):t._e(),2===t.showType||3===t.showType?i("div",{staticClass:"book-shelf-label-list-wrapper"},t._l(t.purchaseData,(function(e,o){return i("div",{key:o,ref:"bookShelfList",refInFor:!0,staticClass:"book-shelf-list-wrapper"},[i("div",{staticClass:"book-shelf-label-item",class:{"is-fixed":e.isFixed}},[i("span",{staticClass:"book-shelf-label-text"},[t._v(t._s(e.label))])]),i("div",{staticClass:"book-shelf-item-wrapper"},t._l(e.bookList,(function(e,o){return i("div",{key:e.id,staticClass:"book-shelf-item",on:{click:function(i){return t.onBookClick(e,o)}}},[i("div",{ref:"bookImg",refInFor:!0,staticClass:"book-img-wrapper",class:{"add-book":3===e.type,"category-book":2===e.type}},[1===e.type?i("shelf-image",{attrs:{data:e,isEditMode:t.isEditMode}}):2===e.type?i("shelf-category",{attrs:{data:e,isEditMode:t.isEditMode}}):i("span",{staticClass:"icon-add icon"})],1),i("div",{staticClass:"book-title-wrapper"},[i("span",{staticClass:"book-title title-small"},[t._v(t._s(e.title))])])])})),0)])})),0):t._e(),i("div",{directives:[{name:"show",rawName:"v-show",value:0===t.showType,expression:"showType === 0"}],staticClass:"book-shelf-statistics"},[t._v(" "+t._s(t.$t("shelf.statistic").replace("$1",t.publicNumber).replace("$2",t.privateNumber))+" ")])],1)},s=[],r=(i("a9e3"),i("4de4"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"shelf-category-wrapper"},[t.data.itemList.length>0?i("div",{staticClass:"shelf-category",class:{"is-edit":t.isEditMode}},t._l(t.data.itemList,(function(t,e){return i("div",{key:e,staticClass:"shelf-category-item"},[i("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.cover,expression:"item.cover"}],staticClass:"shelf-category-img"})])})),0):i("div",{staticClass:"shelf-category-bg"},[i("span",{staticClass:"icon-book2"})])])}),n=[],a={props:{data:Object,isEditMode:Boolean}},c=a,l=(i("461f"),i("2877")),u=Object(l["a"])(c,r,n,!1,null,"7d780b1e",null),h=u.exports,f=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"shelf-image"},[i("img",{staticClass:"book-img",attrs:{src:t.data.cover}}),i("span",{directives:[{name:"show",rawName:"v-show",value:t.isEditMode,expression:"isEditMode"}],staticClass:"icon-selected",class:{"is-selected":t.data.selected}}),i("div",{directives:[{name:"show",rawName:"v-show",value:t.data.private,expression:"data.private"}],staticClass:"private-wrapper"}),i("div",{directives:[{name:"show",rawName:"v-show",value:t.data.private,expression:"data.private"}],staticClass:"private-icon-wrapper"},[i("span",{staticClass:"icon-private"})])])},d=[],p={props:{data:Object,isEditMode:Boolean}},v=p,m=(i("a916"),Object(l["a"])(v,f,d,!1,null,"242fc922",null)),g=m.exports,b=i("fa7d"),w=i("5de6"),k={props:{data:Array,isEditMode:Boolean,showType:{type:Number,default:0}},components:{ShelfCategory:h,ShelfImage:g},computed:{bookData:function(){return 0===this.showType?this.data:1===this.showType?Object(w["g"])(this.data):0},publicNumber:function(){if(this.data){var t=0;return this.data.filter((function(e){e.private||1!==e.type?2===e.type&&e.itemList.length>0&&(t+=e.itemList.filter((function(t){return!t.private&&1===t.type})).length):t++})),t}return 0},privateNumber:function(){if(this.data){var t=0;return this.data.filter((function(e){e.private&&1===e.type?t++:2===e.type&&e.itemList.length>0&&(t+=e.itemList.filter((function(t){return t.private&&1===t.type})).length)})),t}return 0},purchaseData:function(){var t={label:this.$t("shelf.bought"),bookList:this.flatData.filter((function(t){return t.cache})),isFixed:!1},e={label:this.$t("shelf.notPurchased"),bookList:this.flatData.filter((function(t){return!t.cache})),isFixed:!1};return[t,e]},bookShelfList:function(){return this.$refs.bookShelfList[0].getBoundingClientRect().height},bookShelfList2:function(){return this.$refs.bookShelfList[1].getBoundingClientRect().height}},methods:{fixTitle:function(t){2!==this.showType&&3!==this.showType||(t>Object(b["d"])(10)&&t<this.bookShelfList?!1===this.purchaseData[0].isFixed&&(this.purchaseData[0].isFixed=!0,this.purchaseData[1].isFixed=!1,this.$forceUpdate()):t>=this.bookShelfList-Object(b["d"])(42)?!1===this.purchaseData[1].isFixed&&(this.purchaseData[0].isFixed=!1,this.purchaseData[1].isFixed=!0,this.$forceUpdate()):(this.purchaseData[0].isFixed=!1,this.purchaseData[1].isFixed=!1,this.$forceUpdate()))},onBookClick:function(t,e){3===t.type?this.$router.push("/book-store/home"):1===t.type?this.isEditMode?t.selected=!t.selected:this.$emit("onBookClick",t,e):2===t.type&&(this.isEditMode||this.$router.push({path:"/book-store/category",query:{index:e}}))}}},y=k,x=(i("6442"),Object(l["a"])(y,o,s,!1,null,"63e9c616",null));e["a"]=x.exports},"3ca3":function(t,e,i){"use strict";var o=i("6547").charAt,s=i("577e"),r=i("69f3"),n=i("7dd0"),a="String Iterator",c=r.set,l=r.getterFor(a);n(String,"String",(function(t){c(this,{type:a,string:s(t),index:0})}),(function(){var t,e=l(this),i=e.string,s=e.index;return s>=i.length?{value:void 0,done:!0}:(t=o(i,s),e.index+=t.length,{value:t,done:!1})}))},"3fbb":function(t,e,i){"use strict";var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("transition",{attrs:{name:"fade"}},[t.visible?i("div",{staticClass:"shelf-group-dialog-bg"},[t.selectGroupDialogVisible?i("div",{staticClass:"shelf-group-dialog-wrapper"},[i("div",{staticClass:"dialog-list"},[i("div",{staticClass:"dialog-title-wrapper"},[i("span",{staticClass:"dialog-title-text"},[t._v(t._s(t.$t("shelf.moveBook")))])]),i("div",{staticClass:"dialog-list-wrapper"},t._l(t.categoryList,(function(e,o){return i("div",{key:o,staticClass:"dialog-list-item",class:{"is-add":!!e.edit&&1===e.edit},on:{click:function(i){return t.onGroupClick(e)}}},[i("div",{staticClass:"dialog-list-item-text"},[t._v(t._s(e.title))]),t.category&&e.id&&t.category.id===e.id?i("div",{staticClass:"dialog-list-icon-wrapper"},[i("span",{staticClass:"icon-check"})]):t._e()])})),0)]),i("div",{staticClass:"dialog-btn-wrapper",on:{click:t.hide}},[i("div",{staticClass:"dialog-btn"},[t._v(t._s(t.$t("shelf.cancel")))])])]):t._e(),t.newGroupDialogVisible?i("div",{staticClass:"shelf-group-dialog-wrapper"},[i("div",{staticClass:"dialog-list"},[i("div",{staticClass:"dialog-title-wrapper"},[i("span",{staticClass:"dialog-title-text"},[t._v(t._s(t.$t("shelf.newGroup")))])]),i("div",{staticClass:"dialog-input-title-wrapper"},[i("span",{staticClass:"dialog-input-title"},[t._v(t._s(t.$t("shelf.groupName")))])]),i("div",{staticClass:"dialog-input-wrapper"},[i("div",{staticClass:"dialog-input-inner-wrapper"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.newGroupName,expression:"newGroupName"}],ref:"dialogInput",staticClass:"dialog-input",attrs:{type:"text"},domProps:{value:t.newGroupName},on:{input:function(e){e.target.composing||(t.newGroupName=e.target.value)}}}),i("div",{directives:[{name:"show",rawName:"v-show",value:t.newGroupName.length>0,expression:"newGroupName.length > 0"}],staticClass:"dialog-input-clear-wrapper",on:{click:t.clear}},[i("span",{staticClass:"icon-close-circle-fill"})])])])]),i("div",{staticClass:"dialog-btn-wrapper"},[i("div",{staticClass:"dialog-btn",on:{click:t.hide}},[t._v(t._s(t.$t("shelf.cancel")))]),i("div",{staticClass:"dialog-btn",class:{"is-empty":0===t.newGroupName.length},on:{click:t.createNewGroup}},[t._v(" "+t._s(t.$t("shelf.confirm"))+" ")])])]):t._e()]):t._e()])},s=[],r=i("2909"),n=(i("4de4"),i("99af"),{props:{visible:Boolean,data:Array,bookList:Array,isInGroup:Boolean,category:Object,isEditGroupName:{type:Boolean,default:!1}},computed:{defaultCategory:function(){return[{title:this.$t("shelf.newGroup"),edit:1},{title:this.$t("shelf.groupOut"),edit:2}]},categoryList:function(){var t=this.bookList?this.bookList.filter((function(t){return 2===t.type})):[];return[].concat(Object(r["a"])(this.defaultCategory),Object(r["a"])(t))}},data:function(){return{newGroupDialogVisible:!1,selectGroupDialogVisible:!0,newGroupName:""}},methods:{createNewGroup:function(){this.isEditGroupName?(this.$emit("editGroupName",this.category,this.newGroupName),this.hide()):(this.newGroupName.length>0&&this.$emit("group",2,{id:this.bookList[this.bookList.length-2].id+1,itemList:[],selected:!1,title:this.newGroupName,type:2}),this.hide())},clear:function(){this.newGroupName=""},onGroupClick:function(t){t.edit&&1===t.edit?this.showCreateGroupDialog():t.edit&&2===t.edit?(this.$emit("group",3,t),this.hide()):(this.$emit("group",1,t),this.hide())},showCreateGroupDialog:function(){var t=this;this.newGroupDialogVisible=!0,this.selectGroupDialogVisible=!1,this.newGroupName="",this.$nextTick((function(){t.$refs.dialogInput.focus()}))},showEditGroupDialog:function(){var t=this;this.newGroupDialogVisible=!0,this.selectGroupDialogVisible=!1,this.newGroupName=this.category.title,this.$nextTick((function(){t.$refs.dialogInput.focus()}))},show:function(){this.$emit("update:visible",!0)},hide:function(){this.$emit("update:visible",!1),this.newGroupDialogVisible=!1,this.selectGroupDialogVisible=!0}}}),a=n,c=(i("876f"),i("2877")),l=Object(c["a"])(a,o,s,!1,null,"4c6c7877",null);e["a"]=l.exports},"461f":function(t,e,i){"use strict";i("df94")},"4bed":function(t,e,i){"use strict";i.r(e);var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"book-category"},[i("shelf-title",{ref:"shelfTitle",staticClass:"shelf-title",attrs:{title:t.category.title,isEditMode:t.isEditMode,ifShowBack:t.ifShowBack,ifShowClear:t.ifShowClear,ifGroupEmpty:t.isEmpty,data:t.bookList,category:t.category},on:{"update:isEditMode":function(e){t.isEditMode=e},"update:is-edit-mode":function(e){t.isEditMode=e},onEditClick:t.onEditClick,deleteGroup:t.deleteGroup,editGroupName:t.editGroupName}}),t.isEmpty?t._e():i("scroll-view",{ref:"scroll",staticClass:"book-shelf-scroll-wrapper",attrs:{top:42,bottom:t.scrollBottom},on:{onScroll:t.onScroll}},[i("book-shelf",{ref:"bookShelf",staticClass:"book-shelf-list",attrs:{data:t.category.itemList,isEditMode:t.isEditMode},on:{onBookClick:t.onBookClick}})],1),t.isEditMode&&!t.isEmpty?i("book-shelf-footer",{staticClass:"book-shelf-footer",attrs:{data:t.category.itemList,bookList:t.bookList,isInGroup:!0,category:t.category},on:{setPrivate:t.setPrivate,setDownload:t.setDownload,removeBook:t.removeBook,groupEdit:t.groupEdit}}):t._e(),i("toast",{ref:"toast",attrs:{text:t.toastText}}),t.isEmpty?i("div",{staticClass:"shelf-empty-view"},[i("span",{staticClass:"shelf-empty-text"},[t._v(t._s(t.$t("shelf.groupNone")))])]):t._e()],1)},s=[],r=i("cbfb"),n=r["a"],a=(i("5793"),i("2877")),c=Object(a["a"])(n,o,s,!1,null,"063e20e0",null);e["default"]=c.exports},"4df4":function(t,e,i){"use strict";var o=i("0366"),s=i("7b0b"),r=i("9bdd"),n=i("e95a"),a=i("50c4"),c=i("8418"),l=i("35a1");t.exports=function(t){var e,i,u,h,f,d,p=s(t),v="function"==typeof this?this:Array,m=arguments.length,g=m>1?arguments[1]:void 0,b=void 0!==g,w=l(p),k=0;if(b&&(g=o(g,m>2?arguments[2]:void 0,2)),void 0==w||v==Array&&n(w))for(e=a(p.length),i=new v(e);e>k;k++)d=b?g(p[k],k):p[k],c(i,k,d);else for(h=w.call(p),f=h.next,i=new v;!(u=f.call(h)).done;k++)d=b?r(h,g,[u.value,k],!0):u.value,c(i,k,d);return i.length=k,i}},"508e":function(t,e,i){},5793:function(t,e,i){"use strict";i("8259")},"5b6e":function(t,e,i){},"5ef8":function(t,e,i){"use strict";i("d632")},6442:function(t,e,i){"use strict";i("8aa7")},"6dc5":function(t,e,i){},8259:function(t,e,i){},8663:function(t,e,i){"use strict";var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"popup"},[i("transition",{attrs:{name:"fade"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.popupVisible,expression:"popupVisible"}],staticClass:"popup-bg",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.hide.apply(null,arguments)},touchmove:function(t){t.preventDefault()}}})]),i("transition",{attrs:{name:"popup-slide-up"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.popupVisible,expression:"popupVisible"}],staticClass:"popup-wrapper"},[t.title&&t.title.length>0?i("div",{staticClass:"popup-title"},[t._v(" "+t._s(t.title)+" ")]):t._e(),t.thirdText&&t.thirdText.length>0?i("div",{staticClass:"popup-confirm-btn",on:{click:t.third}},[t._v(" "+t._s(t.thirdText)+" ")]):t._e(),i("div",{staticClass:"popup-confirm-btn",class:{"is-remove":t.isRemoveText},on:{click:t.confirm}},[t._v(" "+t._s(t.confirmText)+" ")]),i("div",{staticClass:"popup-cancel-btn",on:{click:t.hide}},[t._v(t._s(t.cancelText))])])])],1)},s=[],r={props:{title:String,confirmText:String,isRemoveText:Boolean,cancelText:String,thirdText:String},data:function(){return{popupVisible:!1,visible:!1}},methods:{third:function(){var t=this;this.hide(),setTimeout((function(){t.$emit("third")}),200)},confirm:function(){var t=this;this.hide(),setTimeout((function(){t.$emit("confirm")}),200)},hide:function(){var t=this;this.popupVisible=!1,setTimeout((function(){t.visible=!1}),200)},show:function(){this.visible=!0,this.popupVisible=!0}}},n=r,a=(i("5ef8"),i("2877")),c=Object(a["a"])(n,o,s,!1,null,"47b831b7",null);e["a"]=c.exports},"876f":function(t,e,i){"use strict";i("99e1")},"8aa7":function(t,e,i){},"96cf":function(t,e,i){var o=function(t){"use strict";var e,i=Object.prototype,o=i.hasOwnProperty,s="function"===typeof Symbol?Symbol:{},r=s.iterator||"@@iterator",n=s.asyncIterator||"@@asyncIterator",a=s.toStringTag||"@@toStringTag";function c(t,e,i){return Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(D){c=function(t,e,i){return t[e]=i}}function l(t,e,i,o){var s=e&&e.prototype instanceof m?e:m,r=Object.create(s.prototype),n=new T(o||[]);return r._invoke=S(t,i,n),r}function u(t,e,i){try{return{type:"normal",arg:t.call(e,i)}}catch(D){return{type:"throw",arg:D}}}t.wrap=l;var h="suspendedStart",f="suspendedYield",d="executing",p="completed",v={};function m(){}function g(){}function b(){}var w={};c(w,r,(function(){return this}));var k=Object.getPrototypeOf,y=k&&k(k(G([])));y&&y!==i&&o.call(y,r)&&(w=y);var x=b.prototype=m.prototype=Object.create(w);function C(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function L(t,e){function i(s,r,n,a){var c=u(t[s],t,r);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"===typeof h&&o.call(h,"__await")?e.resolve(h.__await).then((function(t){i("next",t,n,a)}),(function(t){i("throw",t,n,a)})):e.resolve(h).then((function(t){l.value=t,n(l)}),(function(t){return i("throw",t,n,a)}))}a(c.arg)}var s;function r(t,o){function r(){return new e((function(e,s){i(t,o,e,s)}))}return s=s?s.then(r,r):r()}this._invoke=r}function S(t,e,i){var o=h;return function(s,r){if(o===d)throw new Error("Generator is already running");if(o===p){if("throw"===s)throw r;return B()}i.method=s,i.arg=r;while(1){var n=i.delegate;if(n){var a=$(n,i);if(a){if(a===v)continue;return a}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(o===h)throw o=p,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);o=d;var c=u(t,e,i);if("normal"===c.type){if(o=i.done?p:f,c.arg===v)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(o=p,i.method="throw",i.arg=c.arg)}}}function $(t,i){var o=t.iterator[i.method];if(o===e){if(i.delegate=null,"throw"===i.method){if(t.iterator["return"]&&(i.method="return",i.arg=e,$(t,i),"throw"===i.method))return v;i.method="throw",i.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var s=u(o,t.iterator,i.arg);if("throw"===s.type)return i.method="throw",i.arg=s.arg,i.delegate=null,v;var r=s.arg;return r?r.done?(i[t.resultName]=r.value,i.next=t.nextLoc,"return"!==i.method&&(i.method="next",i.arg=e),i.delegate=null,v):r:(i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,v)}function E(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(E,this),this.reset(!0)}function G(t){if(t){var i=t[r];if(i)return i.call(t);if("function"===typeof t.next)return t;if(!isNaN(t.length)){var s=-1,n=function i(){while(++s<t.length)if(o.call(t,s))return i.value=t[s],i.done=!1,i;return i.value=e,i.done=!0,i};return n.next=n}}return{next:B}}function B(){return{value:e,done:!0}}return g.prototype=b,c(x,"constructor",b),c(b,"constructor",g),g.displayName=c(b,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"===typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,c(t,a,"GeneratorFunction")),t.prototype=Object.create(x),t},t.awrap=function(t){return{__await:t}},C(L.prototype),c(L.prototype,n,(function(){return this})),t.AsyncIterator=L,t.async=function(e,i,o,s,r){void 0===r&&(r=Promise);var n=new L(l(e,i,o,s),r);return t.isGeneratorFunction(i)?n:n.next().then((function(t){return t.done?t.value:n.next()}))},C(x),c(x,a,"Generator"),c(x,r,(function(){return this})),c(x,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var i in t)e.push(i);return e.reverse(),function i(){while(e.length){var o=e.pop();if(o in t)return i.value=o,i.done=!1,i}return i.done=!0,i}},t.values=G,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(_),!t)for(var i in this)"t"===i.charAt(0)&&o.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0],e=t.completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var i=this;function s(o,s){return a.type="throw",a.arg=t,i.next=o,s&&(i.method="next",i.arg=e),!!s}for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r],a=n.completion;if("root"===n.tryLoc)return s("end");if(n.tryLoc<=this.prev){var c=o.call(n,"catchLoc"),l=o.call(n,"finallyLoc");if(c&&l){if(this.prev<n.catchLoc)return s(n.catchLoc,!0);if(this.prev<n.finallyLoc)return s(n.finallyLoc)}else if(c){if(this.prev<n.catchLoc)return s(n.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<n.finallyLoc)return s(n.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i];if(s.tryLoc<=this.prev&&o.call(s,"finallyLoc")&&this.prev<s.finallyLoc){var r=s;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var n=r?r.completion:{};return n.type=t,n.arg=e,r?(this.method="next",this.next=r.finallyLoc,v):this.complete(n)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),_(i),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.tryLoc===t){var o=i.completion;if("throw"===o.type){var s=o.arg;_(i)}return s}}throw new Error("illegal catch attempt")},delegateYield:function(t,i,o){return this.delegate={iterator:G(t),resultName:i,nextLoc:o},"next"===this.method&&(this.arg=e),v}},t}(t.exports);try{regeneratorRuntime=o}catch(s){"object"===typeof globalThis?globalThis.regeneratorRuntime=o:Function("r","regeneratorRuntime = r")(o)}},"99e1":function(t,e,i){},"9bdd":function(t,e,i){var o=i("825a"),s=i("2a62");t.exports=function(t,e,i,r){try{return r?e(o(i)[0],i[1]):e(i)}catch(n){throw s(t),n}}},a630:function(t,e,i){var o=i("23e7"),s=i("4df4"),r=i("1c7e"),n=!r((function(t){Array.from(t)}));o({target:"Array",stat:!0,forced:n},{from:s})},a916:function(t,e,i){"use strict";i("5b6e")},b0c0:function(t,e,i){var o=i("83ab"),s=i("9bf2").f,r=Function.prototype,n=r.toString,a=/^\s*function ([^ (]*)/,c="name";o&&!(c in r)&&s(r,c,{configurable:!0,get:function(){try{return n.call(this).match(a)[1]}catch(t){return""}}})},b31d:function(t,e,i){"use strict";var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"book-shelf-footer"},[t._l(t.tabs,(function(e,o){return i("div",{key:o,staticClass:"book-shelf-tab-wrapper",on:{click:function(i){return t.onTabClick(e)}}},[i("div",{staticClass:"book-shelf-tab"},[1!==e.index||t.isPrivate?t._e():i("div",{staticClass:"icon-private tab-icon",class:{"is-selected":t.isSelected}}),1===e.index&&t.isPrivate?i("div",{staticClass:"icon-private-see tab-icon",class:{"is-selected":t.isSelected}}):t._e(),2!==e.index||t.isDownload?t._e():i("div",{staticClass:"icon-download tab-icon",class:{"is-selected":t.isSelected}}),2===e.index&&t.isDownload?i("div",{staticClass:"icon-download-remove tab-icon",class:{"is-selected":t.isSelected}}):t._e(),3===e.index?i("div",{staticClass:"icon-move tab-icon",class:{"is-selected":t.isSelected}}):t._e(),4===e.index?i("div",{staticClass:"icon-shelf tab-icon",class:{"is-selected":t.isSelected}}):t._e(),i("div",{staticClass:"tab-text",class:{"remove-text":4===e.index,"is-selected":t.isSelected}},[t._v(" "+t._s(t.label(e))+" ")])])])})),i("popup",{ref:"popup",attrs:{title:t.popTitle,confirmText:t.confirmText,isRemoveText:t.isRemoveText,cancelText:t.$t("shelf.cancel")},on:{confirm:t.onConfirm}}),i("shelf-group-dialog",{attrs:{visible:t.ifGroupDialogShow,data:t.data,bookList:t.bookList,category:t.category,isInGroup:t.isInGroup},on:{"update:visible":function(e){t.ifGroupDialogShow=e},group:t.groupEdit}})],2)},s=[],r=(i("159b"),i("ac1f"),i("5319"),i("8663")),n=i("3fbb"),a={props:{data:Array,isInGroup:Boolean,bookList:Array,category:Object},components:{ShelfGroupDialog:n["a"],Popup:r["a"]},computed:{selectedBooks:function(){var t=[];return this.data.forEach((function(e){e.selected&&t.push(e)})),t},isSelected:function(){return!!this.data&&this.data.some((function(t){return t.selected}))},isPrivate:function(){return!!this.isSelected&&this.data.every((function(t){return!t.selected||t.private}))},isDownload:function(){return!!this.isSelected&&this.data.every((function(t){return!t.selected||t.cache}))},tabs:function(){return[{label:this.$t("shelf.private"),label2:this.$t("shelf.noPrivate"),index:1},{label:this.$t("shelf.download"),label2:this.$t("shelf.delete"),index:2},{label:this.$t("shelf.move"),index:3},{label:this.$t("shelf.remove"),index:4}]}},data:function(){return{popTitle:"",confirmText:"",isRemoveText:!1,ifShowPopup:!1,ifGroupDialogShow:!1,onConfirm:function(){}}},methods:{label:function(t){switch(t.index){case 1:return this.isPrivate?t.label2:t.label;case 2:return this.isDownload?t.label2:t.label;default:return t.label}},removeBook:function(){this.$emit("removeBook")},onSetDownload:function(){this.$emit("setDownload",!0)},onRemoveDownload:function(){this.$emit("setDownload",!1)},onSetPrivate:function(){this.$emit("setPrivate",!0)},onCancelPrivate:function(){this.$emit("setPrivate",!1)},onTabClick:function(t){1===t.index?this.showPrivate():2===t.index?this.showDownload():3===t.index?this.showGroupDialog():4===t.index&&this.showRemove()},showGroupDialog:function(){this.isSelected&&(this.ifGroupDialogShow=!0)},showRemove:function(){var t;this.isSelected&&(t=1===this.selectedBooks.length?this.$t("shelf.removeBookTitle").replace("$1","《"+this.selectedBooks[0].title+"》"):this.$t("shelf.removeBookTitle").replace("$1",this.$t("shelf.selectedBooks")),this.showPopup(t,this.$t("shelf.removeBook"),this.removeBook,!0))},showDownload:function(){this.isSelected&&(this.isDownload?this.showPopup(this.$t("shelf.removeDownloadTitle"),this.$t("shelf.delete"),this.onRemoveDownload,!0):this.showPopup(this.$t("shelf.setDownloadTitle"),this.$t("shelf.open"),this.onSetDownload))},showPrivate:function(){this.isSelected&&(this.isPrivate?this.showPopup(this.$t("shelf.closePrivateTitle"),this.$t("shelf.close"),this.onCancelPrivate):this.showPopup(this.$t("shelf.setPrivateTitle"),this.$t("shelf.open"),this.onSetPrivate))},showPopup:function(t,e,i){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.popTitle=t,this.confirmText=e,this.onConfirm=i,this.isRemoveText=o,this.$refs.popup.show()},groupEdit:function(t,e){this.$emit("groupEdit",t,e)}}},c=a,l=(i("fd3f"),i("2877")),u=Object(l["a"])(c,o,s,!1,null,"12474e42",null);e["a"]=u.exports},cbfb:function(t,e,i){"use strict";(function(t){var o=i("1da1"),s=i("2909"),r=(i("96cf"),i("4de4"),i("159b"),i("99af"),i("ac1f"),i("5319"),i("d3b7"),i("3ca3"),i("ddb0"),i("0093")),n=i("2c89"),a=i("4e1b"),c=i("b31d"),l=i("4729"),u=i("e8ec"),h=i("101f"),f=i("365c"),d=i("a211");t.ePub=d["a"];var p="bookShelf";e["a"]={components:{ShelfTitle:r["a"],ScrollView:a["a"],BookShelf:n["a"],BookShelfFooter:c["a"],Toast:l["a"]},computed:{isEmpty:function(){return!(this.category&&this.category.itemList&&this.category.itemList.length>0)}},data:function(){return{index:null,bookList:[],category:{},isEditMode:!1,ifShowBack:!0,ifShowClear:!1,scrollBottom:0,toastText:""}},methods:{editGroupName:function(t,e){t.title=e,this.onEditClick(!1),this.saveBookShelfToLocalStorage()},deleteGroup:function(t){var e=this.getBooksFromCategory(t);this.removeCategory(t),this.clearAddFromBookList(),this.appendBookToList(e),this.appendAddToBookList(),this.onEditClick(!1),this.saveBookShelfToLocalStorage(),this.$router.go(-1)},removeCategory:function(t){this.bookList=this.bookList.filter((function(e){return t.id!==e.id}))},getBooksFromCategory:function(t){return t.itemList},groupEdit:function(t,e){switch(t){case 1:this.moveToGroup(e);break;case 2:this.newGroup(e),this.moveToGroup(e);break;case 3:this.moveOutGroup();break}},getSelectedBooks:function(){var t=this.bookList.filter((function(t){return t.selected}));return this.bookList.filter((function(e){2===e.type&&e.itemList&&e.itemList.filter((function(e){e.selected&&t.push(e)}))})),t},clearSelectedBooks:function(){this.bookList=this.bookList.filter((function(t){return!t.selected})),this.bookList.forEach((function(t){2===t.type&&t.itemList&&(t.itemList=t.itemList.filter((function(t){return!t.selected})))}))},appendBookToList:function(t){var e=this,i=this.bookList[this.bookList.length-1].id+1;t.forEach((function(t){t.id=i++,e.bookList.push(t)}))},moveOutGroup:function(){this.clearAddFromBookList();var t=this.getSelectedBooks();this.clearSelectedBooks(),this.appendBookToList(t),this.appendAddToBookList(),this.onEditClick(!1),this.saveBookShelfToLocalStorage(),this.showToast(this.$t("shelf.moveBookOutSuccess"))},newGroup:function(t){this.clearAddFromBookList(),this.bookList.push(t),this.appendAddToBookList()},moveToGroup:function(t){var e=this.getSelectedBooks();this.clearSelectedBooks(),t&&t.itemList&&(t.itemList=[].concat(Object(s["a"])(t.itemList),Object(s["a"])(e)),t.itemList.forEach((function(t,e){t.id=e+1}))),this.onEditClick(!1),this.saveBookShelfToLocalStorage(),this.showToast(this.$t("shelf.moveBookInSuccess").replace("$1",t.title))},appendAddToBookList:function(){this.bookList.push({cover:"",title:"",type:3,id:this.bookList[this.bookList.length-1].id+1})},clearAddFromBookList:function(){this.bookList=this.bookList.filter((function(t){return 3!==t.type}))},removeBook:function(){this.bookList=this.bookList.filter((function(t){return t.itemList&&(t.itemList=t.itemList.filter((function(t){return!t.selected}))),!t.selected})),this.onEditClick(!1),this.saveBookShelfToLocalStorage()},onBookClick:function(t,e){this.$router.push({path:"/book-store/detail",query:{fileName:t.fileName,category:t.categoryText}})},showToast:function(t){this.toastText=t,this.$refs.toast.show()},removeDownloadBook:function(t){return new Promise((function(e,i){Object(h["c"])(t.fileName,(function(){console.log("[".concat(t.fileName,"]删除成功...")),e()}),i)}))},downloadBook:function(t){return new Promise((function(e,i){Object(h["b"])(t.fileName,(function(o,s){!o&&s instanceof Blob?(console.log("[".concat(t.fileName,"]读取成功..."),s,new d["a"](s)),e()):Object(f["b"])(t,(function(t){console.log("["+t.fileName+"]下载成功..."),e()}),i,i)}))}))},setDownload:function(t){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function i(){var o,s;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:t?e.showToast(e.$t("shelf.setDownloadSuccess")):e.showToast(e.$t("shelf.removeDownloadSuccess")),o=regeneratorRuntime.mark((function i(o){var s,r;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(s=e.bookList[o],!t||!s.selected){i.next=7;break}return console.log("item-正在处理第".concat(o+1,"本书")),i.next=5,e.downloadBook(s).then((function(){s.cache=t}));case 5:i.next=11;break;case 7:if(t||!s.selected){i.next=11;break}return console.log("item-正在处理第".concat(o+1,"本书")),i.next=11,e.removeDownloadBook(s).then((function(){s.cache=t}));case 11:if(!s.itemList){i.next=19;break}r=0;case 13:if(!(r<s.itemList.length)){i.next=19;break}return i.next=16,e.downloadItem(s.itemList[r],t);case 16:r++,i.next=13;break;case 19:case"end":return i.stop()}}),i)})),s=0;case 3:if(!(s<e.bookList.length)){i.next=8;break}return i.delegateYield(o(s),"t0",5);case 5:s++,i.next=3;break;case 8:e.onEditClick(!1),e.saveBookShelfToLocalStorage(),console.log("数据保存成功...");case 11:case"end":return i.stop()}}),i)})))()},downloadItem:function(t,e){var i=this;return Object(o["a"])(regeneratorRuntime.mark((function o(){return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:if(console.log("subItem-正在处理".concat(t.fileName)),!e||!t.selected){o.next=6;break}return o.next=4,i.downloadBook(t).then((function(){t.cache=e}));case 4:o.next=9;break;case 6:if(e||!t.selected){o.next=9;break}return o.next=9,i.removeDownloadBook(t).then((function(){t.cache=e}));case 9:case"end":return o.stop()}}),o)})))()},setPrivate:function(t){this.bookList.forEach((function(e){e.selected&&(e.private=t),e.itemList&&e.itemList.forEach((function(e){e.selected&&(e.private=t)}))})),this.onEditClick(!1),this.saveBookShelfToLocalStorage(),t?this.showToast(this.$t("shelf.setPrivateSuccess")):this.showToast(this.$t("shelf.closePrivateSuccess"))},onEditClick:function(t){var e=this;this.isEditMode=t,this.isEditMode||this.bookList.forEach((function(t){t.bookId?t.selected=!1:t.itemList&&t.itemList.forEach((function(t){t.selected=!1}))})),this.isEditMode?(this.scrollBottom=48,this.$nextTick((function(){e.$refs.scroll&&e.$refs.scroll.refresh()}))):(this.scrollBottom=0,this.$nextTick((function(){e.$refs.scroll&&e.$refs.scroll.refresh()})))},onScroll:function(t){t>0?this.$refs.shelfTitle.showShadow():this.$refs.shelfTitle.hideShadow()},getBookList:function(){this.bookList=this.getBookShelfFromLocalStorage()},getCategoryList:function(){this.index=this.$route.query.index,this.category=this.bookList[this.index],console.log(this.category)},saveBookShelfToLocalStorage:function(){Object(u["v"])(p,this.bookList)},getBookShelfFromLocalStorage:function(){return Object(u["f"])(p)}},mounted:function(){this.getBookList(),this.getCategoryList()}}}).call(this,i("c8ba"))},d28b:function(t,e,i){var o=i("746f");o("iterator")},d632:function(t,e,i){},ddb0:function(t,e,i){var o=i("da84"),s=i("fdbc"),r=i("e260"),n=i("9112"),a=i("b622"),c=a("iterator"),l=a("toStringTag"),u=r.values;for(var h in s){var f=o[h],d=f&&f.prototype;if(d){if(d[c]!==u)try{n(d,c,u)}catch(v){d[c]=u}if(d[l]||n(d,l,h),s[h])for(var p in r)if(d[p]!==r[p])try{n(d,p,r[p])}catch(v){d[p]=r[p]}}}},df94:function(t,e,i){},e5b5:function(t,e,i){"use strict";i("6dc5")},fb6a:function(t,e,i){"use strict";var o=i("23e7"),s=i("861d"),r=i("e8b5"),n=i("23cb"),a=i("50c4"),c=i("fc6a"),l=i("8418"),u=i("b622"),h=i("1dde"),f=h("slice"),d=u("species"),p=[].slice,v=Math.max;o({target:"Array",proto:!0,forced:!f},{slice:function(t,e){var i,o,u,h=c(this),f=a(h.length),m=n(t,f),g=n(void 0===e?f:e,f);if(r(h)&&(i=h.constructor,"function"!=typeof i||i!==Array&&!r(i.prototype)?s(i)&&(i=i[d],null===i&&(i=void 0)):i=void 0,i===Array||void 0===i))return p.call(h,m,g);for(o=new(void 0===i?Array:i)(v(g-m,0)),u=0;m<g;m++,u++)m in h&&l(o,u,h[m]);return o.length=u,o}})},fd3f:function(t,e,i){"use strict";i("508e")}}]);
//# sourceMappingURL=chunk-5eeb2ded.24cfae9d.js.map